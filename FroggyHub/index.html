<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover">
  <title>FroggyHub ‚Äî —Å–æ–±—ã—Ç–∏—è –∏ –≤–∏—à–ª–∏—Å—Ç—ã</title>
  <link rel="stylesheet" href="style.css">
</head>
<body class="scene-intro">
  <!-- –≠–ö–†–ê–ù 1: –í–•–û–î / –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø -->
  <div id="screen-auth" class="container" role="main">
    <div class="card" id="authPanel" style="max-width:620px;margin:40px auto">
      <div class="hero">
        <div class="avatar frog-ava">üê∏</div>
        <div class="hero-text">
          <h1>–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h1>
          <div class="chips">
            <span class="chip">–®–∞–≥ 1</span>
            <span class="chip">–ü—Ä–æ—Ñ–∏–ª—å</span>
          </div>
        </div>
      </div>

      <div class="tabs" role="tablist" aria-label="Auth">
        <button id="tab-login" class="tab is-active" role="tab" aria-controls="pane-login" aria-selected="true">–í–æ–π—Ç–∏</button>
        <button id="tab-register" class="tab" role="tab" aria-controls="pane-register" aria-selected="false">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
      </div>

      <section id="pane-login" class="pane grid" role="tabpanel" aria-labelledby="tab-login">
        <label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
          <input id="login-username" type="text" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required autocomplete="username">
        </label>
        <label>–ü–∞—Ä–æ–ª—å
          <input id="login-password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" minlength="4" required autocomplete="current-password">
        </label>
        <button type="button" class="btn primary" id="login-btn" data-action="login">–í–æ–π—Ç–∏</button>
        <button type="button" class="btn" id="showReset" data-forgot="false">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</button>
        <div id="resetPassBlock" class="grid is-hidden">
          <label>–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å
            <input id="resetPass" type="password" minlength="4" autocomplete="new-password">
          </label>
          <label>–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å
            <input id="resetPass2" type="password" minlength="4" autocomplete="new-password">
          </label>
        </div>
        <div id="login-status" aria-live="polite"></div>
      </section>

      <section id="pane-register" class="pane grid is-hidden" role="tabpanel" aria-labelledby="tab-register">
        <label>–ò–º—è / –ù–∏–∫–Ω–µ–π–º
          <input id="signup-username" required minlength="2" autocomplete="nickname">
        </label>
        <label>–ü–∞—Ä–æ–ª—å
          <input id="signup-password" type="password" required minlength="4" autocomplete="new-password">
        </label>
        <label>–ü–æ–≤—Ç–æ—Ä –ø–∞—Ä–æ–ª—è
          <input id="signup-password2" type="password" required minlength="4" autocomplete="new-password">
        </label>
        <button id="signup-btn" class="btn primary" type="button" data-action="signup">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
        <div id="reg-status" aria-live="polite"></div>
      </section>
    </div>
  </div>

  <!-- –≠–ö–†–ê–ù 2: –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ -->
  <div id="screen-lobby" class="container" hidden>
    <div class="card" style="max-width:760px;margin:28px auto">
      <div class="hero">
        <div class="avatar frog-ava">üê∏</div>
        <div class="hero-text">
          <h1>–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</h1>
          <div class="chips">
            <span class="chip">–®–∞–≥ 2</span>
            <span class="pill" data-user-badge>–≥–æ—Å—Ç—å</span>
            <button class="btn ghost small" id="logout-btn" data-action="logout" title="–í—ã–π—Ç–∏">–í—ã–π—Ç–∏</button>
          </div>
        </div>
      </div>

      <div class="grid">
        <button class="btn primary" id="goCreate" data-requires-auth data-action="create-event">üß™ –°–æ–∑–¥–∞—Ç—å –∏–≤–µ–Ω—Ç</button>
        <div class="card inner">
          <h3>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∏–≤–µ–Ω—Ç—É</h3>
          <div class="row2">
            <input id="join-code" placeholder="–í–≤–µ–¥–∏—Ç–µ 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥" inputmode="numeric" pattern="\d*" autocomplete="one-time-code" maxlength="6">
            <button class="btn" id="join-btn" data-action="join-event" disabled>üéâ –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- –≠–ö–†–ê–ù 3: –ü–†–£–î + –§–ò–ù–ê–õ -->
  <div id="screen-app" hidden>
    <div class="wrap" id="root">
      <section class="pond" id="pond">
        <div class="ripples" aria-hidden="true"></div>
        <div class="pads" id="pads"></div>

        <!-- –ë–û–õ–¨–®–ò–ï –ß–ê–°–´ (–≤ —Ñ–∏–Ω–∞–ª–µ –ø–µ—Ä–µ–µ–∑–∂–∞—é—Ç –≤ –ª–µ–≤—É—é –∫–æ–ª–æ–Ω–∫—É) -->
        <div id="bigClock" class="big-clock" hidden>
          <div class="hm" id="bigClockHM">00:00</div>
          <div class="days" id="bigClockDays">0 –¥–Ω–µ–π</div>
        </div>

        <!-- –ü–µ–Ω—å –∏ –ª—è–≥—É—à–∫–∞ -->
        <img id="stumpImg" class="stump" src="assets/stump.png" alt="–ü–µ–Ω—å" />
        <div id="frog"><img id="frogImg" src="assets/frog_idle.png" alt="Frog" /></div>

        <!-- –§–ò–ù–ê–õ–¨–ù–ê–Ø –†–ê–°–ö–õ–ê–î–ö–ê: –î–í–ï –ö–û–õ–û–ù–ö–ò -->
        <div id="finalLayout" class="final-layout" hidden>
          <div id="finalLeft" class="final-left" aria-hidden="false"></div>
          <div id="finalRight" class="final-right">
            <div class="final-card">
              <header class="final-header">
                <div class="title" id="fTitle">–°–æ–±—ã—Ç–∏–µ</div>
                <!-- chips –±—ã–ª–∏ –ª–∏—à–Ω–∏–º–∏ ‚Äî —Å–∫—Ä—ã–≤–∞–µ–º -->
                <div class="final-chips" id="fChips" hidden>
                  <span class="chip" id="fDateChip">‚Äî</span>
                  <span class="chip" id="fTimeChip">‚Äî</span>
                  <span class="chip" id="fAddrChip">‚Äî</span>
                </div>
              </header>

              <section class="final-main">
                <div class="tagline" id="fNotes">–û–ø–∏—Å–∞–Ω–∏–µ / –¥–µ—Ç–∞–ª–∏.</div>

                <div class="meta">
                  <div class="meta-item">–î—Ä–µ—Å—Å-–∫–æ–¥: <strong id="fDress">‚Äî</strong></div>
                  <div class="meta-item">–ß—Ç–æ –≤–∑—è—Ç—å: <strong id="fBring">‚Äî</strong></div>
                </div>

                <div class="wl-block">
                  <div class="wl-head">
                    <h3>Wishlist</h3>
                    <div class="wl-legend">
                      <span class="pill-mini">üü¢ —Å–≤–æ–±–æ–¥–Ω–æ</span>
                      <span class="pill-mini">üîí –∑–∞–Ω—è—Ç–æ</span>
                    </div>
                  </div>
                  <div id="fWishlist" class="wl-scroll"></div>
                </div>

                <div class="dashboard">
                  <div class="db-card" id="fStats"></div>
                  <div class="db-card" id="fShare"></div>
                </div>
              </section>
            </div>
          </div>
        </div>

        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∏–Ω—Ç—Ä–æ) -->
        <div class="speech" id="speech">
          <div id="speechText"><strong>–§—Ä–æ–≥–≥–∏:</strong> –ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å?</div>
          <div class="actions" id="speechActions">
            <button class="pill" data-next="create" data-requires-auth>üß™ –°–æ–∑–¥–∞—Ç—å</button>
            <button class="pill secondary" data-next="join">üéâ –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</button>
          </div>
        </div>
      </section>

      <!-- –ù–ò–ñ–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ / –®–ê–ì–ò -->
      <section class="panel" id="slides">
        <!-- –°–û–ó–î–ê–¢–¨: —Ñ–æ—Ä–º–∞ —Å–æ–±—ã—Ç–∏—è -->
        <section id="slide-create-1" hidden>
          <div class="bubble">
            <div class="bubble-head">–§—Ä–æ–≥–≥–∏:</div>
            <div class="bubble-body">–ù–∞–∑–≤–∞–Ω–∏–µ, –¥–∞—Ç–∞, –≤—Ä–µ–º—è, –∞–¥—Ä–µ—Å.</div>
          </div>
          <form id="formCreate" class="grid brick">
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è <input id="eventTitle" required /></label>
            <div class="row2">
              <label>–î–∞—Ç–∞ <input id="eventDate" type="date" required /></label>
              <label>–í—Ä–µ–º—è <input id="eventTime" type="time" required /></label>
            </div>
            <label>–ê–¥—Ä–µ—Å <input id="eventAddress" placeholder="–£–ª–∏—Ü–∞, –¥–æ–º, –≥–æ—Ä–æ–¥" /></label>
            <button class="btn" type="submit">–î–∞–ª–µ–µ</button>
          </form>
        </section>

        <!-- –°–û–ó–î–ê–¢–¨: –≤–∏—à–ª–∏—Å—Ç -->
        <section id="slide-create-wishlist" hidden>
          <div class="bubble"><div class="bubble-head">–§—Ä–æ–≥–≥–∏:</div><div class="bubble-body">–î–æ–±–∞–≤—å—Ç–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è.</div></div>
          <div class="wl-wrap"><div id="wlGrid" class="gridVar"></div></div>
          <div class="bar-actions">
            <button class="btn" id="addItem">–î–æ–±–∞–≤–∏—Ç—å</button>
            <button class="btn ghost" id="clearWL">–û—á–∏—Å—Ç–∏—Ç—å</button>
            <button class="btn" id="toDetails">–î–∞–ª–µ–µ</button>
          </div>
          <dialog id="cellEditor" aria-modal="true" role="dialog">
            <form method="dialog" class="editor">
              <h3>–†–µ–¥–∞–∫—Ç–æ—Ä</h3>
              <label>–ù–∞–∑–≤–∞–Ω–∏–µ <input id="cellTitle" /></label>
              <label>–°—Å—ã–ª–∫–∞ <input id="cellUrl" placeholder="https://..." /></label>
              <menu>
                <button value="cancel" class="btn ghost">–û—Ç–º–µ–Ω–∞</button>
                <button id="saveCell" value="default" class="btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
              </menu>
            </form>
          </dialog>
        </section>

        <!-- –°–û–ó–î–ê–¢–¨: –¥–æ–ø. —É—Å–ª–æ–≤–∏—è -->
        <section id="slide-create-details" hidden>
          <div class="bubble"><div class="bubble-head">–§—Ä–æ–≥–≥–∏:</div><div class="bubble-body">–î—Ä–µ—Å—Å-–∫–æ–¥, —á—Ç–æ –≤–∑—è—Ç—å, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.</div></div>
          <form id="formDetails" class="grid brick">
            <label>–î—Ä–µ—Å—Å-–∫–æ–¥ <input id="eventDress" /></label>
            <label>–ß—Ç–æ –≤–∑—è—Ç—å <input id="eventBring" /></label>
            <label>–ö–∞–∫ –ø—Ä–æ–π—Ç–∏ / –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ <textarea id="eventNotes" rows="3"></textarea></label>
            <button class="btn" type="submit" data-requires-auth>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button>
          </form>
          <p id="createEventStatus" class="error" role="status" aria-live="polite"></p>
        </section>

        <!-- –°–û–ó–î–ê–¢–¨: –∞–¥–º–∏–Ω -->
        <section id="slide-admin" hidden>
          <div class="bubble"><div class="bubble-head">–§—Ä–æ–≥–≥–∏:</div><div class="bubble-body">–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –∫–æ–¥–æ–º.</div></div>
          <p><strong>–ö–æ–¥ —Å–æ–±—ã—Ç–∏—è:</strong> <span class="code-box" id="eventCode">‚Äî</span> <button class="btn small" id="copyCodeBtn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥</button> <a id="analyticsLink" class="btn small" href="#" hidden>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Å–æ–±—ã—Ç–∏—è</a></p>
          <p id="codeExpire" class="hint"></p>
          <h3>–í–∏—à–ª–∏—Å—Ç</h3>
          <ul id="adminGifts" class="list"></ul>
          <div class="bar-actions"><button class="btn" id="finishCreate">–ö —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ</button></div>
        </section>

        <!-- –ü–†–ò–°–û–ï–î–ò–ù–ò–¢–¨–°–Ø: –∫–æ–¥ -->
        <section id="slide-join-code" hidden>
          <div class="bubble"><div class="bubble-head">–§—Ä–æ–≥–≥–∏:</div><div class="bubble-body">–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥.</div></div>
          <div class="grid" style="place-items:center">
            <input id="joinCodeInput" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 345812" style="max-width:260px;text-align:center" inputmode="numeric" pattern="\d*" autocomplete="one-time-code" maxlength="6" />
            <button class="btn" id="joinCodeBtn" disabled>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
            <div id="joinCodeError" class="error" role="status" aria-live="polite"></div>
          </div>
        </section>

        <!-- –ü–†–ò–°–û–ï–î–ò–ù–ò–¢–¨–°–Ø: –∏–º—è + RSVP -->
        <section id="slide-join-1" hidden>
          <div class="bubble"><div class="bubble-head">–§—Ä–æ–≥–≥–∏:</div><div class="bubble-body">–í–∞—à–µ –∏–º—è –∏ —Å—Ç–∞—Ç—É—Å —É—á–∞—Å—Ç–∏—è.</div></div>
          <form id="formJoin" class="grid brick">
            <label>–ò–º—è <input id="guestName" required /></label>
            <div class="btn-group">
              <button type="button" class="btn yes" data-rsvp="yes">–ò–¥—É</button>
              <button type="button" class="btn maybe" data-rsvp="maybe">–í–æ–∑–º–æ–∂–Ω–æ</button>
              <button type="button" class="btn no" data-rsvp="no">–ù–µ –∏–¥—É</button>
            </div>
            <button id="toGuestWishlist" class="btn" type="button">–í—ã–±—Ä–∞—Ç—å –ø–æ–¥–∞—Ä–æ–∫</button>
          </form>
        </section>

        <!-- –ü–†–ò–°–û–ï–î–ò–ù–ò–¢–¨–°–Ø: –≤–∏—à–ª–∏—Å—Ç –≥–æ—Å—Ç—è -->
        <section id="slide-join-wishlist" hidden>
          <div class="bubble"><div class="bubble-head">–§—Ä–æ–≥–≥–∏:</div><div class="bubble-body">–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –ø—É–Ω–∫—Ç.</div></div>
          <div id="guestGifts" class="wishlist-grid"></div>
          <div class="bar-actions">
            <button class="btn ghost" id="skipWishlist">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
            <button class="btn" id="toGuestFinal">–ì–æ—Ç–æ–≤–æ</button>
          </div>
        </section>
      </section>
    </div>
  </div>

  <script>
    // TODO: –∑–∞–ø–æ–ª–Ω–∏—Ç—å –¥–ª—è –ø—Ä–æ–¥—ã —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è Netlify
    window.SUPABASE_URL = "https://smamhlfzserjkdfhthwhdv.supabase.co";
    window.PROXY_SUPABASE_URL = location.origin + '/supabase';
    window.SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNtYW1obGZ6ZXJqa2RmaHR3aGR2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxMzQ0MzYsImV4cCI6MjA3MDcxMDQzNn0.PwRF3OAtlpJ7zu2lsIb46V7XLINlyhfC97Jgbu--Vv4";
  </script>
  <script defer type="module" src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm"></script>
  <script defer src="app.js"></script>
  <div id="sessionBanner" role="status" aria-live="polite" hidden>–°–µ—Å—Å–∏—è –∏—Å—Ç–µ–∫–ª–∞, –≤–æ–π–¥–∏—Ç–µ —Å–Ω–æ–≤–∞</div>
  <dialog id="otpModal">
    <form method="dialog" class="grid">
      <p>–í–æ–π—Ç–∏ –ø–æ —Å—Å—ã–ª–∫–µ</p>
      <label>–ü–æ—á—Ç–∞
        <input id="otpEmail" type="email" required>
      </label>
      <div class="row2">
        <button class="btn primary" id="otpSendBtn" type="button">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É</button>
        <button class="btn" value="cancel">–û—Ç–º–µ–Ω–∞</button>
      </div>
      <p id="otpStatus" class="hint" aria-live="polite"></p>
    </form>
  </dialog>
    <div id="cookieBanner" role="dialog" aria-modal="true" hidden>
      <div class="cookie-text">
        <p>–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º cookies. –°–æ–≥–ª–∞—Å–Ω—ã?</p>
        <label><input type="checkbox" id="cookieAnalytics"> –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</label>
        <div id="cookieStatus" class="visually-hidden" aria-live="polite"></div>
      </div>
      <div class="cookie-actions">
        <button id="cookieAccept" type="button" class="btn yes">–ü—Ä–∏–Ω—è—Ç—å –≤—Å–µ</button>
        <button id="cookieDecline" type="button" class="btn ghost">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–±–æ—Ä</button>
      </div>
    </div>
    <div id="toast" class="toast" role="status" aria-live="polite" hidden></div>
  </body>
  </html>
